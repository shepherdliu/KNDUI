## <span id="data">data</span>

- 功能
  
    - 显示、修改系统数据和KUI脚本的自定义变量
- 支持的数据
    - [诊断参数](../参数及表达式.html#diagnose) K/D/T/C/X/Y/R/S/F/G，支持位型/字节型参数（诊断参数的非位型数据可以设置数据类型，共6种，u8/u16/u32/s8/s16/s32，s表示有符号数，u表示无符号数，数字表示数据的位数，默认为u8。形式为xxx[type]，如K8[u16]，表示K区8号参数，无符号16位）
    - [宏变量 #](../参数及表达式.html#macro)
    - [系统参数](../参数及表达式.html#system) 格式可为P414， P415-1，P1105.1-1
    - [表达式](../参数及表达式.html#expressionRules) 如(K12[u8]+#500)/2，会显示诊断参数K12加上#500后除以2得到的值
    - [KUI脚本的自定义变量](../参数及表达式.html#diy)，自定义变量名称可以为小写字母或小写字母+数字，不支持大写字母，为了区别于系统数据，将自定义变量包含在大括号{}内，形如{v1}
- 参数
    - 描述的数据
    - (起始行，起始列, 占几行（默认占1行）,占几列（默认占1列）)
    - [颜色](../控件属性.html#color)(不设为默认值)
    - [字体大小](../控件属性.html#font)(不设为默认值)
    - [读写模式](../控件属性.html#mode)：默认是"确认"模式(可以为"只读"或"确认"，表达式无法被赋值，只能是"只读"的)
    - [线框格式](../控件属性.html#lineShow)：默认为不隐藏，在此处写入"隐藏"则会隐藏控件四周的线框
    - enable表达式： 当该表达式值不为0时该控件才可以修改，等于0时控件不捕获光标，故不能修改。若不设置该参数，则可以修改(此参数仅在"确认"模式下有用)
    - id 控件名称，用于标识控件，控件名称不可重复，如果不需要可以不设置
    - choices参数为对data控件的扩展，语法为choices={54: "这是G54"，55: "这是G55"}，大括号中每一个被逗号分隔的单元都应该是一个"键--值对"，冒号前面的为"键"，后面的为"值"，大括号中可以包含若干个"键--值对"
    	- 当模式为只读时，控件显示与数据相等的"键"对应的"值"，当数据不与任何"键"相等时显示数据的值（如果这不是你设计的初衷，那么要避免出现这样的情况）
    	- 当模式为确认时，控件显示一个下拉文本框，文本框包含大括号里面所有的"值"，选择某个"值"会将相对应的"键"值赋给数据，若参数action有效会同时响应相关动作。数据和大括号里面的所有"键"值都不相等时文本框显示"无效"两个字
    - action为响应动作，可以通过设置action参数实现为data控件输入值时执行相应的动作，action取值可以为"运行脚本"、"运行脚本文件"、"运行MDI"，在"确认"模式下使用
        - 运行脚本：语法为：action=运行脚本("xxx")，括号中的字符串为符合KUI脚本语法的若干语句。当操作者手动改变控件数据值时，将执行这些语句
        - 运行脚本文件：语法为：action=运行脚本文件("xxx.prg")，括号中的字符串为KUI脚本文件名称，文件需放到当前目录下。当操作者手动改变控件数据值时，将执行此文件
        - 运行MDI：语法为：action=运行MDI，需要与choices参数联合使用，在选择文本框中选择相应"值"时会在MDI模式下执行"值"字符串，如果不符合语法将报错
    - left 左边控件, right右边控件, prev上一控件, next下一控件(对应数控系统面板上的"左"/"右"/"上"/"下"按键)，当需要设置控件的光标顺序时设置左右上下控件名称即可，4个参数可以设置0个或多个
- 控件应用分析与举例
此控件应用广泛，参数较多，使用较为复杂。首先介绍基础用法，然后再介绍带choices和action参数的用法。
1. 此控件的基础用法用于显示、编辑某一变量或系统参数的值，可根据需要设置控件的读写模式，线框格式等属性。
2. choices参数是对data控件基础功能的扩展，只读模式下，可以用此控件显示一些字符串。例如，根据宏变量#4005的值来显示此时的工作坐标系。确认模式下，可以用此控件显示一个下拉文本框，选择下拉框中的"值"会将其对应的"键"值赋给指定的变量。
3. action参数使操作此控件时机床能执行设定的"动作"。
例如，要实现在一个圆周上钻孔的特定功能，可以将一些数值参数做成普通的data控件，使操作者可以手动输入合适的值；一些参数只有特定的几个选项可以选择加入choices参数的data控件做成下拉文本框，如钻孔的加工方式选择"G81"、"G82"、"G83"；左侧显示坐标处可以选择加入choices参数的data控件，在只读模式下显示目前的工件坐标系

<img src="pictures\data控件应用举例.BMP" alt="新建工程" style="zoom: 80%;" />

```python
with page(510, 792, id="主页面", text=(边界白色, f20x10, 左对齐)):
    picture("圆周钻孔.bmp", (1, 1, 510, 792))
    text("绝对坐标", (350, 20, 23, 100), 绿色, f24x12)
    data("#4005", (350, 121, 20, 50), 绿色, f24x12, 左对齐, 只读, choices={54: "G54", 55: "G55", 56: "G56", 57: "G57"})     #data控件加入choices参数，并设置为只读模式，显示对应的字符串，这里根据#4005的值显示目前的工件坐标系

    text("X", (390, 78, 20, 20), 居中, f24x12)
    coor("X", (390, 100, 20, 110), 右对齐, 绝对, 青色, f24x12)
    text("Y", (425, 78, 20, 20), 居中, f24x12)
    coor("Y", (425, 100, 20, 110), 右对齐, 绝对, 青色, f24x12)
    text("Z", (460, 78, 20, 20), 居中, f24x12)
    coor("Z", (460, 100, 20, 110), 右对齐, 绝对, 青色, f24x12)
    
    data("{v502}", (130, 654, 30, 96), 确认)
    data("{v503}", (170, 654, 30, 96), f20x10, 确认)
    data("{v504}", (210, 654, 30, 96), 确认)
    data("{v505}", (250, 654, 30, 96), 确认)
    data("{v506}", (290, 654, 30, 96), choices={81: "G81", 82: "G82", 83: "G83"})      #data控件加入choices参数显示为下拉文本框，操作者可以选择钻孔方式
```