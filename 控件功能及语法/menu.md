## menu

- 功能
    - 自定义界面菜单
- 参数
    - 菜单名称
    - Action菜单动作
        - [示教绝对](#teach_abs)
        - [示教机床](#teach_machine)
        - [示教表达式](#teach_expression)
        - [测量](#measure)
        - [加输入](#add_input)
        - [部分表达式](#part_expression)
        - [表达式](#expression)
        - [页面跳转](#goto_page)
        - [页面选择](#select_page)
        - [工件坐标](#work_coor)
        - [信号翻转](#signal_overturn)
        - [生成程序](#gen_prog)
    - enable表达式 当该表达式值不为0时，菜单才显示深色(可以响应按键)否则显示灰色(不响应按键)，不设置enable则无影响
- 语法与功能详解
下面1~6号菜单与teach控件联合使用
<span id="teach_abs">1. 示教绝对</span>：单轴示教时直接写入"示教绝对"，当光标停留在示教坐标数据的teach控件上时，菜单显示深色(可以响应按键)，按下菜单时执行示教绝对坐标的动作。示教轴组时写入"示教绝对(group=x)"，x为相应的轴组号。
```python
teach("#530", "X", (4, 1), group=2)
teach("#531", "Y", (4, 2))
teach("#533", "Z", (4, 4), group=2) 
menu("示教组2", 示教绝对(group=2) #光标停留在1/3行对应的控件上时，此菜单可以响应按键。键按下时同时给#530和#533赋值为X/Z轴的绝对坐标值？？？？待解决。
menu("示教", 示教绝对)  #光标停留在以上任意一个控件上时，此菜单可以响应按键。键按下时执行相应控件的示教绝对坐标动作
```
<span id="teach_machine">2. 示教机床</span>：单轴示教时直接写入"示教机床"，当光标停留在示教坐标数据的teach控件上时，菜单显示深色(可以响应按键)，按下菜单时执行示教机床坐标的动作。示教轴组时写入"示教机床(group=x)"，x为相应的轴组号。
```python
teach("#530", "X", (4, 1), group=2)
teach("#531", "Y", (4, 2))
teach("#533", "Z", (4, 4), group=2) 
menu("示教组2", 示教机床(group=2) #光标停留在1/3行对应的控件上时，此菜单可以响应按键。键按下时同时给#530和#533赋值为X/Z轴的机床坐标值
menu("示教", 示教机床)  #光标停留在以上任意一个控件上时，此菜单可以响应按键。键按下时执行相应控件的示教机床坐标动作
```
<span id="teach_expression">3. 示教表达式</span>：示教单个表达式时直接写入"示教表达式"，当光标停留在示教表达式的teach控件上时，菜单显示深色(可以响应按键)，按下菜单时执行示教表达式的动作。示教表达式组时写入"示教表达式(group=x)"，x为相应的表达式组
```python
teach("#530", "F156[s16]/100", (4, 1), group=2)
teach("#531", "F1805[u32]/1000", (4, 2))
teach("#533", "P414", (4, 4), group=2) 
menu("示教组2", 示教表达式(group=2) #光标停留在1/3行对应的控件上时，此菜单可以响应按键。键按下时同时给#530和#533赋值为相应表达式的计算结果
menu("示教", 示教机床)  #光标停留在以上任意一个控件上时，此菜单可以响应按键。键按下时计算表达式的值赋给宏变量
```
在以下3个菜单中定义2个变量$m和$v。$v为当前示教控件的编辑值，$m与$v的关系由菜单的类型决定。3个菜单都要与形如teach("#530"，"#530 + $m"，(4,  1))的控件联合使用。
<span id="measure">4. 测量</span>：在测量控件中$m= -$v，按下菜单键时将当前控件值减去控件的编辑值作为控件的新值，类似测量功能
```python
teach("#530", "#530 + $m", (4, 1))
menu("测量", 测量) #菜单名称为"测量"，当光标停留在上面的teach控件上，并输入了编辑值2时此菜单可以响应按键。键按下时相当于执行#530=#530-2
```
<span id="add_input">5. 加输入</span>：在加输入控件中$m= $v，按下菜单键时将当前控件值加上控件的编辑值作为控件的新值，类似 +输入功能
```python
teach("#530", "#530 + $m", (4, 1))
menu("+输入", 加输入) #菜单名称为"+输入"，当光标停留在上面的teach控件上，并输入了编辑值2时此菜单可以响应按键。键按下时相当于执行#530=#530+2
```
<span id="part_expression">6. 部分表达式</span>：在部分表达式中$m和$v的关系由表达式决定，$m="表达式"，按下菜单键时将当前控件值加上表达式计算结果值作为控件的新值
```python
teach("#530", "#530 + $m", (4, 1))
menu("测试", 部分表达式("$v - 3")) #菜单名称为"测试"，当光标停留在上面的teach控件上，并输入了编辑值2时此菜单可以响应按键。键按下时相当于执行#530=#530+2-3
```
<span id="expression">7. 表达式</span>：参数为一个赋值表达式，如"#500=#501+1"
```python
teach("表达式", 表达式("#500=#501+1"))  #菜单名称为"表达式"，键按下时执行赋值动作
```
<span id="goto_page">8. 页面跳转</span>：直接写入页面id，按菜单时会跳转到相应页面
```python
with page(5, 4, id="page1"):
	······
	
with page(5, 4, id="page2"):
	······
    menu("切换page1"，"page1") #菜单名称为"切换page1"，键按下时切换到id="page1"的页面

```
<span id="select_page">9. 页面选择</span>：可以根据某一PLC参数的值跳转到相应页面。语法举例：页面选择("K100",("page1", "page2", "page3"))。当K100(此处仅支持PLC参数)的值为0/1/2时分别跳转到id为page1/page2/page3的页面。此时PLC参数类型为U8，页面最多不要超过64个。当PLC参数的值不对应任何id时将跳转到第一个id对应的页面
```python
with page(5, 4, id="page1"):
	······
	
with page(5, 4, id="page2"):
	······

with page(5, 4, id="page3"):
	······
	
with page(5, 4, id="page4"):
	······
menu("页面选择"，页面选择("K100",("page1", "page2", "page3"))  #菜单名称为"页面选择"，当K100(此处仅支持PLC参数)的值为0/1/2时分别跳转到id为page1/page2/page3的页面
```
<span id="work_coor">10. 工件坐标</span>： 切换到相应的工件坐标系。语法举例：工件坐标("G55")
```python
menu("切换G55", 工件坐标("G55")) #菜单名称为"切换G55"，键按下时执行切换到工件坐标G55的操作
```
<span id="signal_overturn">11. 信号翻转</span>：将相应地址的位信号翻转(在0/1之间转换)，支持的数据与switch控件相同
```python
menu("翻转", 信号翻转("F5231.1")) #菜单名称为"翻转"，键按下时将F5231.1翻转
```
<span id="gen_prog">12. 生成程序</span>：第一个参数为程序模板文件名称（同一路径下），第二个参数为要生成的程序号(在系统端生成程序时要打开程序开关)。在点击"生成程序"时程序模板文件中使用到的宏变量要有值，否则会报错。
```python
menu("程序", 生成程序("O0002.prg", 12))  #菜单名称为"程序"，KUI脚本程序O0002.prg在当前目录下，键按下时将以O0002.prg为模板生成程序"O0012.PRG"
```